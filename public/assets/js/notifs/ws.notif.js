// Generated by CoffeeScript 1.12.5

/*
WebSocket Notification class.
Refer to layout view.
 */

(function() {
  this.WsNotif = (function() {
    function WsNotif(wsUri, topicUri) {
      var conn, ctx, protocol;
      protocol = window.location.protocol === 'http:' ? 'ws:' : 'wss:';
      wsUri = protocol + "//" + wsUri;
      ctx = this;
      conn = new ab.Session(wsUri, function() {
        return conn.subscribe(topicUri, ctx.onSub);
      }, function() {
        return console.log('something went wrong.');
      }, {
        'skipSubprotocolCheck': true
      });
    }

    WsNotif.prototype.onSub = function(topic, data) {
      return console.log(topic, data);
    };

    return WsNotif;

  })();

  $(document).ready(function() {
    return new WsNotif($('#push-notif').data('host'), $('#push-notif').data('topic'));
  });

}).call(this);
